{
  "meta": {
    "project": "ShoeShop E-commerce System",
    "date": "2025-11-14",
    "prepared_by": "Generated by TestSprite"
  },
  "product_overview": "ShoeShop is an e-commerce platform specializing in footwear that supports multiple user roles (Customer, Staff, Manager, Admin) and covers features including product catalog browsing, shopping cart management, order lifecycle management, discount code application, secure payment integration with VNPay, and user access management, built with Java, Spring Boot, MySQL, and JWT security.",
  "core_goals": [
    "Deliver a reliable and performant online shoe-store platform.",
    "Provide comprehensive product catalog browsing with detailed filtering and sorting.",
    "Enable smooth shopping cart operations with real-time updates and discount application.",
    "Support secure and flexible checkout with VNPay payment integration and order lifecycle management.",
    "Enforce role-based access control for Customers, Staff, Managers, and Admins.",
    "Ensure robust order state transitions and accurate order processing workflows.",
    "Allow efficient user and role management by administrative users.",
    "Offer management and tracking of discounts with usage conditions and validations."
  ],
  "key_features": [
    "Authentication API for secure login, token management, and password handling.",
    "Product Catalog API enabling product listing, filtering by brand and gender, and detailed views.",
    "Shopping Cart API for adding, updating, and viewing cart items with discount support and session persistence.",
    "Order API supporting order creation, cancellation, discount application, and lifecycle updates.",
    "Order Detail API providing order tracking, status updates, and historical order retrieval per user.",
    "User Management API for customer registration, user details access, updates, and role management.",
    "Payment API integrating VNPay for payment processing and secure callback handling.",
    "Role-based access control mechanisms enforcing permissions across all features.",
    "Discount code management for creating, applying, and monitoring promo codes by Managers and Admins."
  ],
  "user_flow_summary": [
    "Customers browse and filter product catalog, view details, add items to cart, and apply discounts.",
    "Customers proceed to checkout by entering shipping info, selecting payment method (COD or VNPay), and placing orders.",
    "System creates orders with initial CREATED status; Staff and Manager update order statuses through defined transitions.",
    "Customers track orders and may cancel when allowed by status (CREATED or CONFIRMED).",
    "Managers create and manage discount codes; customers apply discounts during cart or checkout.",
    "Admins manage users and roles, lock/unlock accounts, and view system-wide reports.",
    "Payment processes via VNPay with callback validation to confirm payment success.",
    "Authentication flow includes login, token introspection, and logout ensuring secure access."
  ],
  "validation_criteria": [
    "All API endpoints respond within 2 seconds under expected load.",
    "Access control rules enforce permissions strictly per role (Customer, Staff, Manager, Admin).",
    "Order state transitions obey business rules with validation preventing invalid status changes.",
    "Discount application logic verifies eligibility and responds with clear error messages on failure.",
    "Payment integration with VNPay completes full transaction flows including callback handling with secure hash verification.",
    "User registration and profile updates properly persist and enforce validation rules.",
    "Cart operations correctly update quantities and prices dynamically and persist across sessions.",
    "Test coverage includes functional scenarios for each role and core workflows, with manual and automated testing."
  ],
  "code_summary": {
    "tech_stack": [
      "Java",
      "Spring Boot",
      "MySQL",
      "JWT"
    ],
    "features": [
      {
        "name": "Authentication API",
        "description": "Handles user login, token introspection, logout, password management",
        "files": [
          "back-end/src/main/java/fpl/sd/backend/controller/AuthenticationController.java"
        ],
        "api_doc": {
          "paths": {
            "/auth/token": {
              "post": {
                "summary": "Authenticate user",
                "requestBody": {
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "username": {
                            "type": "string"
                          },
                          "password": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Success"
                  }
                }
              }
            },
            "/auth/introspect": {
              "post": {
                "summary": "Introspect token",
                "requestBody": {
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "token": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Product Catalog API",
        "description": "Provides product listing, filtering, details",
        "files": [
          "back-end/src/main/java/fpl/sd/backend/controller/ShoeController.java"
        ],
        "api_doc": {
          "paths": {
            "/shoes": {
              "get": {
                "summary": "Get shoes list",
                "parameters": [
                  {
                    "name": "brandId",
                    "in": "query",
                    "schema": {
                      "type": "integer"
                    }
                  },
                  {
                    "name": "gender",
                    "in": "query",
                    "schema": {
                      "type": "string"
                    }
                  }
                ]
              }
            },
            "/shoes/{id}": {
              "get": {
                "summary": "Get shoe by ID",
                "parameters": [
                  {
                    "name": "id",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "integer"
                    }
                  }
                ]
              }
            }
          }
        }
      },
      {
        "name": "Cart API",
        "description": "Manages shopping cart operations",
        "files": [
          "back-end/src/main/java/fpl/sd/backend/controller/CartController.java"
        ],
        "api_doc": {
          "paths": {
            "/cart": {
              "get": {
                "summary": "Get cart"
              },
              "post": {
                "summary": "Add to cart",
                "requestBody": {
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "variantId": {
                            "type": "string"
                          },
                          "quantity": {
                            "type": "integer"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Order API",
        "description": "Handles order creation, discount application, cancellation",
        "files": [
          "back-end/src/main/java/fpl/sd/backend/controller/OrderController.java"
        ],
        "api_doc": {
          "paths": {
            "/orders/create": {
              "post": {
                "summary": "Create order",
                "security": [
                  {
                    "bearerAuth": []
                  }
                ],
                "requestBody": {
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "shippingAddress": {
                            "type": "string"
                          },
                          "paymentMethod": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "/orders/{orderId}/cancel": {
              "post": {
                "summary": "Cancel order",
                "security": [
                  {
                    "bearerAuth": []
                  }
                ],
                "parameters": [
                  {
                    "name": "orderId",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  }
                ]
              }
            }
          }
        }
      },
      {
        "name": "Order Detail API",
        "description": "Manages order tracking and status updates",
        "files": [
          "back-end/src/main/java/fpl/sd/backend/controller/OrderDetailController.java"
        ],
        "api_doc": {
          "paths": {
            "/order-details/user/{username}": {
              "get": {
                "summary": "Get orders by user",
                "security": [
                  {
                    "bearerAuth": []
                  }
                ],
                "parameters": [
                  {
                    "name": "username",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  }
                ]
              }
            },
            "/order-details": {
              "get": {
                "summary": "Get all orders",
                "security": [
                  {
                    "bearerAuth": []
                  }
                ]
              }
            },
            "/order-details/order/{orderId}": {
              "get": {
                "summary": "Get order by ID",
                "security": [
                  {
                    "bearerAuth": []
                  }
                ],
                "parameters": [
                  {
                    "name": "orderId",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  }
                ]
              },
              "put": {
                "summary": "Update order status",
                "security": [
                  {
                    "bearerAuth": []
                  }
                ],
                "parameters": [
                  {
                    "name": "orderId",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "requestBody": {
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "status": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "User Management API",
        "description": "Admin user management",
        "files": [
          "back-end/src/main/java/fpl/sd/backend/controller/UserController.java"
        ],
        "api_doc": {
          "paths": {
            "/users": {
              "get": {
                "summary": "Get all users",
                "security": [
                  {
                    "bearerAuth": []
                  }
                ]
              },
              "post": {
                "summary": "Register user"
              }
            },
            "/users/{userId}": {
              "get": {
                "summary": "Get user by ID",
                "security": [
                  {
                    "bearerAuth": []
                  }
                ],
                "parameters": [
                  {
                    "name": "userId",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  }
                ]
              },
              "put": {
                "summary": "Update user",
                "security": [
                  {
                    "bearerAuth": []
                  }
                ],
                "parameters": [
                  {
                    "name": "userId",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  }
                ]
              }
            }
          }
        }
      },
      {
        "name": "Payment API",
        "description": "Handles VNPay payment processing",
        "files": [
          "back-end/src/main/java/fpl/sd/backend/controller/VNPayController.java"
        ],
        "api_doc": {
          "paths": {
            "/payment/create": {
              "post": {
                "summary": "Create payment",
                "security": [
                  {
                    "bearerAuth": []
                  }
                ],
                "requestBody": {
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "orderId": {
                            "type": "string"
                          },
                          "amount": {
                            "type": "number"
                          },
                          "bankCode": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            },
            "/payment/payment-callback": {
              "post": {
                "summary": "Payment callback",
                "requestBody": {
                  "content": {
                    "application/x-www-form-urlencoded": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "vnp_ResponseCode": {
                            "type": "string"
                          },
                          "vnp_TxnRef": {
                            "type": "string"
                          },
                          "vnp_SecureHash": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    ]
  }
}
